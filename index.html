<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Access the Hathi Trust Bookworm and Extracted Features Files from R • hathiTools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Access the Hathi Trust Bookworm and Extracted Features Files from R">
<meta property="og:description" content='The package allows one to query the Hathi Trust Digital Library Bookworm and Workset Builder, as well as to download the "extracted features" and metadata files for more than 17 million digitized volumes.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">hathiTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/topic_models_using_hathi_ef.html">Topic Modeling using the Hathi Trust Extracted Features Files</a>
    </li>
    <li>
      <a href="articles/using_the_hathi_bookworm.html">Using the Hathi Trust Bookworm Tool</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="hathitools">hathiTools<a class="anchor" aria-label="anchor" href="#hathitools"></a>
</h1></div>
<!-- badges: start -->

<p>This package allows you to interact with various free data resources made available by the Hathi Trust digital library, including the Hathi Trust <a href="https://bookworm.htrc.illinois.edu/develop/" class="external-link">Bookworm</a>, a tool similar to the <a href="https://books.google.com/ngrams" class="external-link">Google ngram viewer</a> and the Hathi Trust <a href="https://solr2.htrc.illinois.edu/solr-ef/" class="external-link">Workset Builder 2.0</a>. It also allows you to download and process the <a href="https://analytics.hathitrust.org/datasets" class="external-link">Hathi Trust Extracted Features files</a>, which contain per-page word counts and part-of-speech information for over 15 million digitised volumes, including many of those originally digitised by Google for its Google Books project.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package is not yet on CRAN. Install from GitHub as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"xmarquez/hathiTools"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="downloading-word-frequencies">Downloading word frequencies<a class="anchor" aria-label="anchor" href="#downloading-word-frequencies"></a>
</h2>
<p>The simplest task to use the package for is to download word frequencies from the Hathi Trust <a href="https://bookworm.htrc.illinois.edu/develop/" class="external-link">Bookworm</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xmarquez.github.io/hathiTools">hathiTools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</span>
<span class="co">#&gt; v ggplot2 3.3.5     v purrr   0.3.4</span>
<span class="co">#&gt; v tibble  3.1.4     v dplyr   1.0.7</span>
<span class="co">#&gt; v tidyr   1.1.3     v stringr 1.4.0</span>
<span class="co">#&gt; v readr   2.0.1     v forcats 0.5.1</span>
<span class="co">#&gt; -- Conflicts ------------------------------------------ tidyverse_conflicts() --</span>
<span class="co">#&gt; x dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span>

<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/query_bookworm.html">query_bookworm</a></span><span class="op">(</span>word <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"democracy"</span>, <span class="st">"monarchy"</span><span class="op">)</span>, lims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1760</span>, <span class="fl">2000</span><span class="op">)</span>, counttype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WordsPerMillion"</span>, <span class="st">"TextPercent"</span><span class="op">)</span><span class="op">)</span>

<span class="va">result</span>
<span class="co">#&gt; # A tibble: 964 x 4</span>
<span class="co">#&gt;    word      date_year value counttype      </span>
<span class="co">#&gt;    &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;          </span>
<span class="co">#&gt;  1 democracy      1760 0.382 WordsPerMillion</span>
<span class="co">#&gt;  2 democracy      1760 2.50  TextPercent    </span>
<span class="co">#&gt;  3 democracy      1761 0.300 WordsPerMillion</span>
<span class="co">#&gt;  4 democracy      1761 2.13  TextPercent    </span>
<span class="co">#&gt;  5 democracy      1762 0.352 WordsPerMillion</span>
<span class="co">#&gt;  6 democracy      1762 2.00  TextPercent    </span>
<span class="co">#&gt;  7 democracy      1763 0.488 WordsPerMillion</span>
<span class="co">#&gt;  8 democracy      1763 1.94  TextPercent    </span>
<span class="co">#&gt;  9 democracy      1764 0.663 WordsPerMillion</span>
<span class="co">#&gt; 10 democracy      1764 2.37  TextPercent    </span>
<span class="co">#&gt; # ... with 954 more rows</span>

<span class="va">result</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">word</span>, <span class="va">counttype</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>rolling_avg <span class="op">=</span> <span class="fu">slider</span><span class="fu">::</span><span class="fu">slide_dbl</span><span class="op">(</span><span class="va">value</span>, <span class="va">mean</span>, .before <span class="op">=</span> <span class="fl">10</span>, .after <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_year</span>, color <span class="op">=</span> <span class="va">word</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_year</span>, y <span class="op">=</span> <span class="va">rolling_avg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">counttype</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">""</span>, subtitle <span class="op">=</span> <span class="st">"10 year rolling average, books published between 1760-2000"</span>,
       title <span class="op">=</span> <span class="st">"Frequency of 'democracy' and 'monarchy' in the HathiTrust corpus"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>There are more than 13 million texts in the bookworm database.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">total_texts</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/query_bookworm.html">query_bookworm</a></span><span class="op">(</span>counttype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TotalTexts"</span><span class="op">)</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_year"</span>, <span class="st">"language"</span><span class="op">)</span>,
                          lims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2020</span><span class="op">)</span><span class="op">)</span>

<span class="va">total_texts</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 1</span>
<span class="co">#&gt;      value</span>
<span class="co">#&gt;      &lt;int&gt;</span>
<span class="co">#&gt; 1 13786170</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span>

<span class="va">total_texts</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date_year</span> <span class="op">&gt;</span> <span class="fl">1500</span>, <span class="va">date_year</span> <span class="op">&lt;</span> <span class="fl">2001</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>language <span class="op">=</span> <span class="fu">fct_lump_n</span><span class="op">(</span><span class="va">language</span>, <span class="fl">10</span>, w <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">date_year</span>, <span class="va">language</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">language</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">date_year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">date_year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">language</span><span class="op">)</span>, <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">language</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>rolling_avg <span class="op">=</span> <span class="fu">slider</span><span class="fu">::</span><span class="fu">slide_dbl</span><span class="op">(</span><span class="va">value</span>, <span class="va">mean</span>, .before <span class="op">=</span> <span class="fl">10</span>, .after <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_year</span>, y <span class="op">=</span> <span class="va">rolling_avg</span>, color <span class="op">=</span> <span class="va">language</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">language</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_year</span>, y <span class="op">=</span> <span class="va">value</span>, label <span class="op">=</span> <span class="va">label</span>, color <span class="op">=</span> <span class="va">language</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Total texts per language in the HathiTrust bookworm"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Log scale. Less common languages grouped as 'other'. 10 year rolling average."</span>, 
       x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'date_year'. You can override using the `.groups` argument.</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<p>See the article “<a href="articles/using_the_hathi_bookworm">Using the Hathi Bookworm</a>” for more on how to query the bookworm to get word frequencies grouped by particular fields and/or limited to specific categories.</p>
</div>
<div class="section level2">
<h2 id="creating-worksets-of-hathi-trust-ids">Creating Worksets of Hathi Trust IDs<a class="anchor" aria-label="anchor" href="#creating-worksets-of-hathi-trust-ids"></a>
</h2>
<p>We can also create worksets of Hathi Trust IDs for volumes in the digital library that meet specific criteria, such as all volumes that mention “liberal” and “democracy” in the same page, or all volumes with by Alexis de Tocqueville in the “author” field.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/workset_builder.html">workset_builder</a></span><span class="op">(</span><span class="st">"liberal democracy"</span>, volumes_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">result2</span>
<span class="co">#&gt; # A tibble: 6,193 x 2</span>
<span class="co">#&gt;    htid                     id                                  </span>
<span class="co">#&gt;    &lt;chr&gt;                    &lt;chr&gt;                               </span>
<span class="co">#&gt;  1 aeu.ark:/13960/t05x3k82c aeu.ark:/13960/t05x3k82c.page-000075</span>
<span class="co">#&gt;  2 aeu.ark:/13960/t6pz5zs5h aeu.ark:/13960/t6pz5zs5h.page-000251</span>
<span class="co">#&gt;  3 aeu.ark:/13960/t7pn9qp4g aeu.ark:/13960/t7pn9qp4g.page-000394</span>
<span class="co">#&gt;  4 aeu.ark:/13960/t8qc19m2f aeu.ark:/13960/t8qc19m2f.page-000222</span>
<span class="co">#&gt;  5 chi.090309143            chi.090309143.page-000227           </span>
<span class="co">#&gt;  6 chi.096292271            chi.096292271.page-000333           </span>
<span class="co">#&gt;  7 chi.096292271            chi.096292271.page-000364           </span>
<span class="co">#&gt;  8 chi.096292336            chi.096292336.page-000337           </span>
<span class="co">#&gt;  9 chi.096292336            chi.096292336.page-000368           </span>
<span class="co">#&gt; 10 chi.101607416            chi.101607416.page-001182           </span>
<span class="co">#&gt; # ... with 6,183 more rows</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/workset_builder.html">workset_builder</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Alexis de Tocqueville"</span><span class="op">)</span>
<span class="va">result3</span>
<span class="co">#&gt; # A tibble: 417 x 2</span>
<span class="co">#&gt;    htid                         n</span>
<span class="co">#&gt;    &lt;chr&gt;                    &lt;int&gt;</span>
<span class="co">#&gt;  1 aeu.ark:/13960/t00z8277t   506</span>
<span class="co">#&gt;  2 aeu.ark:/13960/t0ms4jd0t   419</span>
<span class="co">#&gt;  3 aeu.ark:/13960/t0wq0sh3s   455</span>
<span class="co">#&gt;  4 aeu.ark:/13960/t0wq0sh9p   445</span>
<span class="co">#&gt;  5 aeu.ark:/13960/t18k8252g   386</span>
<span class="co">#&gt;  6 aeu.ark:/13960/t23b7448p   649</span>
<span class="co">#&gt;  7 aeu.ark:/13960/t2h717j0v   607</span>
<span class="co">#&gt;  8 aeu.ark:/13960/t2k65c727   543</span>
<span class="co">#&gt;  9 aeu.ark:/13960/t3qv43c3w   516</span>
<span class="co">#&gt; 10 aeu.ark:/13960/t6252fd09   382</span>
<span class="co">#&gt; # ... with 407 more rows</span></code></pre></div>
<p>We can browse these volumes interactively in the Hathi Trust website:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/browse_htids.html">browse_htids</a></span><span class="op">(</span><span class="va">result2</span><span class="op">)</span></code></pre></div>
<p>See the article “<a href="topic_models_using_hathi_ef">Topic Models Using Hathi Extracted Features</a>” for more on creating and using with worksets for specific analysis purposes.</p>
</div>
<div class="section level2">
<h2 id="downloading-extracted-feature-files-for-specific-hathi-trust-volumes">Downloading extracted feature files for specific Hathi Trust volumes<a class="anchor" aria-label="anchor" href="#downloading-extracted-feature-files-for-specific-hathi-trust-volumes"></a>
</h2>
<p>We can download the Extracted Features file associated with any of these HathiTrust IDs:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span> 

<span class="va">extracted_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_hathi_counts.html">get_hathi_counts</a></span><span class="op">(</span><span class="va">result3</span><span class="op">$</span><span class="va">htid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, dir <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span>

<span class="va">extracted_features</span>
<span class="co">#&gt; # A tibble: 71,102 x 6</span>
<span class="co">#&gt;    htid                     token POS   count section  page</span>
<span class="co">#&gt;    &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 aeu.ark:/13960/t0ms4jd0t II    NNP       1 body        1</span>
<span class="co">#&gt;  2 aeu.ark:/13960/t0ms4jd0t ``    ``        2 body        1</span>
<span class="co">#&gt;  3 aeu.ark:/13960/t0ms4jd0t *     SYM       2 body        1</span>
<span class="co">#&gt;  4 aeu.ark:/13960/t0ms4jd0t 23    CD        1 body        1</span>
<span class="co">#&gt;  5 aeu.ark:/13960/t0ms4jd0t %     NN        4 body        1</span>
<span class="co">#&gt;  6 aeu.ark:/13960/t0ms4jd0t n     NN        1 body        1</span>
<span class="co">#&gt;  7 aeu.ark:/13960/t0ms4jd0t .     .         2 body        1</span>
<span class="co">#&gt;  8 aeu.ark:/13960/t0ms4jd0t 9     CD        1 body        1</span>
<span class="co">#&gt;  9 aeu.ark:/13960/t0ms4jd0t &lt;     JJR       1 body        1</span>
<span class="co">#&gt; 10 aeu.ark:/13960/t0ms4jd0t U     NNP       1 body        1</span>
<span class="co">#&gt; # ... with 71,092 more rows</span></code></pre></div>
<p>And we can extract the metadata for any of them as well:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_hathi_meta.html">get_hathi_meta</a></span><span class="op">(</span><span class="va">result3</span><span class="op">$</span><span class="va">htid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, dir <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span>

<span class="va">meta</span>
<span class="co">#&gt; # A tibble: 30 x 3</span>
<span class="co">#&gt;    field         value                                         htid             </span>
<span class="co">#&gt;    &lt;chr&gt;         &lt;chr&gt;                                         &lt;chr&gt;            </span>
<span class="co">#&gt;  1 schemaVersion https://schemas.hathitrust.org/EF_Schema_Met~ aeu.ark:/13960/t~</span>
<span class="co">#&gt;  2 id            http://hdl.handle.net/2027/aeu.ark:/13960/t0~ aeu.ark:/13960/t~</span>
<span class="co">#&gt;  3 type          DataFeedItem                                  aeu.ark:/13960/t~</span>
<span class="co">#&gt;  4 type          Book                                          aeu.ark:/13960/t~</span>
<span class="co">#&gt;  5 dateCreated   20200209                                      aeu.ark:/13960/t~</span>
<span class="co">#&gt;  6 title         De la démocratie en Amérique                  aeu.ark:/13960/t~</span>
<span class="co">#&gt;  7 contributor   http://www.viaf.org/viaf/66474207             aeu.ark:/13960/t~</span>
<span class="co">#&gt;  8 contributor   http://id.loc.gov/ontologies/bibframe/Person  aeu.ark:/13960/t~</span>
<span class="co">#&gt;  9 contributor   Tocqueville, Alexis de, 1805-1859.            aeu.ark:/13960/t~</span>
<span class="co">#&gt; 10 pubDate       1848                                          aeu.ark:/13960/t~</span>
<span class="co">#&gt; # ... with 20 more rows</span></code></pre></div>
<p>We can also get the metadata for many or all of these books at the same time:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_workset_meta.html">get_workset_meta</a></span><span class="op">(</span><span class="va">result3</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, metadata_dir <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span>
<span class="co">#&gt; Getting download key...</span>
<span class="co">#&gt; Downloading metadata for 10 volumes. This might take some time.</span>
<span class="co">#&gt; Rows: 10 Columns: 36</span>
<span class="co">#&gt; -- Column specification --------------------------------------------------------</span>
<span class="co">#&gt; Delimiter: ","</span>
<span class="co">#&gt; chr  (20): htBibUrl, volumeIdentifier, rightsAttributes, title, genre, pubPl...</span>
<span class="co">#&gt; dbl   (3): schemaVersion, pubDate, hathitrustRecordNumber</span>
<span class="co">#&gt; lgl  (11): sourceInstitutionRecordNumber, enumerationChronology, governmentD...</span>
<span class="co">#&gt; dttm  (2): dateCreated, lastUpdateDate</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; i Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; i Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>

<span class="va">meta</span>
<span class="co">#&gt; # A tibble: 10 x 36</span>
<span class="co">#&gt;    htBibUrl  schemaVersion volumeIdentifier rightsAttributes title genre pubDate</span>
<span class="co">#&gt;    &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 http://c~           1.3 aeu.ark:/13960/~ pd               De l~ "[\"~    1850</span>
<span class="co">#&gt;  2 http://c~           1.3 aeu.ark:/13960/~ pd               De l~ "[\"~    1848</span>
<span class="co">#&gt;  3 http://c~           1.3 aeu.ark:/13960/~ pd               Demo~ "[\"~    1899</span>
<span class="co">#&gt;  4 http://c~           1.3 aeu.ark:/13960/~ pd               De l~ "[\"~    1848</span>
<span class="co">#&gt;  5 http://c~           1.3 aeu.ark:/13960/~ pdus             Demo~ "[\"~    1889</span>
<span class="co">#&gt;  6 http://c~           1.3 aeu.ark:/13960/~ pd               Demo~ "[\"~    1898</span>
<span class="co">#&gt;  7 http://c~           1.3 aeu.ark:/13960/~ pd               Demo~ "[\"~    1863</span>
<span class="co">#&gt;  8 http://c~           1.3 aeu.ark:/13960/~ pd               De l~ "[\"~    1850</span>
<span class="co">#&gt;  9 http://c~           1.3 aeu.ark:/13960/~ pd               Demo~ "[\"~    1838</span>
<span class="co">#&gt; 10 http://c~           1.3 aeu.ark:/13960/~ pd               De l~ "[\"~    1848</span>
<span class="co">#&gt; # ... with 29 more variables: pubPlace &lt;chr&gt;, typeOfResource &lt;chr&gt;,</span>
<span class="co">#&gt; #   bibliographicFormat &lt;chr&gt;, language &lt;chr&gt;, dateCreated &lt;dttm&gt;,</span>
<span class="co">#&gt; #   lastUpdateDate &lt;dttm&gt;, imprint &lt;chr&gt;, isbn &lt;chr&gt;, issn &lt;chr&gt;, oclc &lt;chr&gt;,</span>
<span class="co">#&gt; #   lccn &lt;chr&gt;, classification &lt;chr&gt;, handleUrl &lt;chr&gt;,</span>
<span class="co">#&gt; #   hathitrustRecordNumber &lt;dbl&gt;, sourceInstitutionRecordNumber &lt;lgl&gt;,</span>
<span class="co">#&gt; #   sourceInstitution &lt;chr&gt;, accessProfile &lt;chr&gt;, enumerationChronology &lt;lgl&gt;,</span>
<span class="co">#&gt; #   governmentDocument &lt;lgl&gt;, names &lt;chr&gt;, issuance &lt;chr&gt;, ...</span></code></pre></div>
<p>One can also turn a workset into a list of htids for downloading their extracted features via rsync:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="reference/htid_to_rsync.html">htid_to_rsync</a></span><span class="op">(</span><span class="va">result3</span><span class="op">$</span><span class="va">htid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">tmp</span><span class="op">)</span>
<span class="co">#&gt; Use rsync -av --files-from C:\Users\marquexa\AppData\Local\Temp\RtmpCEOgEB\file60d0600439d3 data.analytics.hathitrust.org::features-2020.03/ hathi-ef/ to download EF files to hathi-ef directory</span></code></pre></div>
<p>There’s a convenience function that will attempt to do this for you in one command.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/rsync_from_hathi.html">rsync_from_hathi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This requires having rsync installed; see the article “<a href="topic_models_using_hathi_ef">Topic Models Using Hathi Extracted Features</a>” for more on rsyncing large numbers of Hathi Trust JSON extracted features files and caching them to other formats for analysis.</p>
<p>It is also possible to download the big “<a href="https://www.hathitrust.org/hathifiles" class="external-link">hathifile</a>” to get basic metadata for ALL of the texts in the Hathi Trust digital library; this is useful for selecting random samples.</p>
</div>
<div class="section level2">
<h2 id="credits">Credits<a class="anchor" aria-label="anchor" href="#credits"></a>
</h2>
<p>This package includes some code from the <a href="https://github.com/HumanitiesDataAnalysis/hathidy" class="external-link">hathidy</a> and <a href="https://github.com/bmschmidt/edinburgh/" class="external-link">edinburgh</a> repos by @bmschmidt.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hathiTools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Xavier Marquez <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/xmarquez/hathiTools/actions" class="external-link"><img src="https://github.com/xmarquez/hathiTools/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Xavier Marquez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
